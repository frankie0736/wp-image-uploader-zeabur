# WordPresså›¾ç‰‡ä¸Šä¼ å·¥å…· - Cursor AI å¼€å‘è§„åˆ™

## ğŸ¯ é¡¹ç›®æ¦‚è¿°
è¿™æ˜¯ä¸€ä¸ªWordPresså›¾ç‰‡ä¸Šä¼ å·¥å…·é¡¹ç›®ï¼Œä½¿ç”¨React + Node.jsæŠ€æœ¯æ ˆï¼Œé‡‡ç”¨Dockerå®¹å™¨åŒ–éƒ¨ç½²ã€‚

## ğŸ“‹ åˆ†æ”¯ç®¡ç†è§„åˆ™

### ğŸŒŸ ä¸¥æ ¼éµå®ˆåˆ†æ”¯ç»“æ„
- **mainåˆ†æ”¯**ï¼šä»…åŒ…å«éƒ¨ç½²æ–‡ä»¶(docker-compose.yml, start.sh, README.md, .gitignore)ï¼Œç”¨æˆ·å‹å¥½
- **devåˆ†æ”¯**ï¼šå®Œæ•´æºä»£ç ï¼Œæ‰€æœ‰å¼€å‘å·¥ä½œéƒ½åœ¨æ­¤åˆ†æ”¯è¿›è¡Œ
- **ç¦æ­¢**ï¼šç›´æ¥åœ¨mainåˆ†æ”¯è¿›è¡Œæºä»£ç å¼€å‘

### âš ï¸ å…³é”®ç¦ä»¤
1. **ç»å¯¹ä¸èƒ½**å°†src/ã€server/ç­‰æºä»£ç ç›®å½•æ¨é€åˆ°mainåˆ†æ”¯
2. **ç»å¯¹ä¸èƒ½**åœ¨mainåˆ†æ”¯è¿›è¡ŒåŠŸèƒ½å¼€å‘
3. **ç»å¯¹ä¸èƒ½**åˆ é™¤æˆ–ç ´ådevåˆ†æ”¯
4. **ç»å¯¹ä¸èƒ½**å¼ºåˆ¶æ¨é€è¦†ç›–è¿œç¨‹åˆ†æ”¯(é™¤éæ˜ç¡®æˆæƒ)

## ğŸš€ å¼€å‘å·¥ä½œæµç¨‹

### 1. å¼€å§‹ä»»ä½•å¼€å‘å·¥ä½œ
```bash
# å¿…é¡»å…ˆåˆ‡æ¢åˆ°devåˆ†æ”¯
git checkout dev
git pull origin dev
```

### 2. è¿›è¡Œå¼€å‘
- æ‰€æœ‰ä»£ç ä¿®æ”¹éƒ½åœ¨devåˆ†æ”¯
- å®šæœŸæäº¤å¹¶æ¨é€åˆ°devåˆ†æ”¯
- ä½¿ç”¨æ¸…æ™°çš„commit message

### 3. éƒ¨ç½²æ–‡ä»¶æ›´æ–°
å½“éœ€è¦æ›´æ–°éƒ¨ç½²ç›¸å…³æ–‡ä»¶æ—¶ï¼š
```bash
# åœ¨devåˆ†æ”¯ä¿®æ”¹éƒ¨ç½²æ–‡ä»¶
git checkout dev
# ä¿®æ”¹åæäº¤åˆ°devåˆ†æ”¯
git add .
git commit -m "update: ä¼˜åŒ–éƒ¨ç½²é…ç½®"
git push origin dev

# åŒæ­¥åˆ°mainåˆ†æ”¯
git checkout main
git checkout dev -- start.sh docker-compose.yml README.md .gitignore
git add .
git commit -m "sync: åŒæ­¥éƒ¨ç½²æ–‡ä»¶æ›´æ–°"
git push origin main
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆä¿¡æ¯

### å‰ç«¯ (React + Vite)
- æ¡†æ¶ï¼šReact 18
- æ„å»ºå·¥å…·ï¼šVite
- å¼€å‘ç«¯å£ï¼š5173
- UIåº“ï¼šAnt Design
- æ ·å¼ï¼šCSS Modules + Tailwind CSS

### åç«¯ (Node.js + Express)
- æ¡†æ¶ï¼šExpress.js
- æ•°æ®åº“ï¼šPostgreSQL (Neon DB)
- æ–‡ä»¶å­˜å‚¨ï¼šæœ¬åœ°å­˜å‚¨ + å¯é€‰äº‘å­˜å‚¨
- è¿è¡Œç«¯å£ï¼š3001

### éƒ¨ç½² (Docker)
- å®¹å™¨åŒ–ï¼šDocker + Docker Compose
- é•œåƒï¼šfrankie0736/wp-image-uploader:latest
- å¹³å°ï¼šlinux/amd64

## ğŸ“ é¡¹ç›®ç»“æ„ç†è§£

### devåˆ†æ”¯ç»“æ„
```
â”œâ”€â”€ src/                    # Reactå‰ç«¯æºç 
â”‚   â”œâ”€â”€ components/         # Reactç»„ä»¶
â”‚   â”œâ”€â”€ hooks/             # è‡ªå®šä¹‰hooks
â”‚   â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ styles/            # æ ·å¼æ–‡ä»¶
â”œâ”€â”€ server/                # Node.jsåç«¯æºç 
â”‚   â”œâ”€â”€ routes/            # è·¯ç”±æ–‡ä»¶
â”‚   â”œâ”€â”€ middleware/        # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/            # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ uploads/           # ä¸Šä¼ æ–‡ä»¶å­˜å‚¨
â”œâ”€â”€ public/                # é™æ€èµ„æº
â”œâ”€â”€ package.json           # å‰ç«¯ä¾èµ–
â”œâ”€â”€ server/package.json    # åç«¯ä¾èµ–
â”œâ”€â”€ Dockerfile             # Dockeræ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml     # Dockerç¼–æ’æ–‡ä»¶
â”œâ”€â”€ start.sh              # å¯åŠ¨è„šæœ¬
â””â”€â”€ README.md             # é¡¹ç›®è¯´æ˜
```

### mainåˆ†æ”¯ç»“æ„
```
â”œâ”€â”€ docker-compose.yml     # Dockerç¼–æ’æ¨¡æ¿
â”œâ”€â”€ start.sh              # ä¸€é”®å¯åŠ¨è„šæœ¬
â”œâ”€â”€ README.md             # ç”¨æˆ·ä½¿ç”¨è¯´æ˜
â””â”€â”€ .gitignore            # éƒ¨ç½²ç”¨å¿½ç•¥è§„åˆ™
```

## ğŸ”§ å¼€å‘å‘½ä»¤

### æœ¬åœ°å¼€å‘
```bash
npm run dev          # å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨
npm run server       # å¯åŠ¨åç«¯å¼€å‘æœåŠ¡å™¨
npm start           # åŒæ—¶å¯åŠ¨å‰åç«¯
npm run build       # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
```

### Dockeræ“ä½œ
```bash
# æ„å»ºé•œåƒ
docker build --platform linux/amd64 -t frankie0736/wp-image-uploader:latest .

# æ¨é€é•œåƒ
docker push frankie0736/wp-image-uploader:latest
# æ¨é€æˆåŠŸåï¼Œåˆ é™¤æœ¬åœ°é•œåƒ
docker rmi frankie0736/wp-image-uploader:latest
```

## ğŸš¨ å¸¸è§è¸©å‘è®°å½•ä¸è§£å†³æ–¹æ¡ˆ

### 1. ğŸ”¥ SharpåŒ…ä¾èµ–é—®é¢˜
**é—®é¢˜ç°è±¡**ï¼š
```
Error: Cannot find module '../build/Release/sharp-linuxmusl-x64.node'
Something went wrong installing the "sharp" module
```

**æ ¹æœ¬åŸå› **ï¼š
- Sharpæ˜¯å›¾ç‰‡å¤„ç†åº“ï¼Œéœ€è¦ç¼–è¯‘äºŒè¿›åˆ¶æ–‡ä»¶
- Alpine Linuxä½¿ç”¨musl libcï¼Œéœ€è¦ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶
- Dockeræ„å»ºæ—¶å®‰è£…é¡ºåºé”™è¯¯å¯¼è‡´ç¼–è¯‘çš„äºŒè¿›åˆ¶æ–‡ä»¶è¢«è¦†ç›–

**è§£å†³æ–¹æ¡ˆ**ï¼š
```dockerfile
# âŒ é”™è¯¯åšæ³•ï¼šåœ¨å¤åˆ¶ä»£ç å‰å®‰è£…Sharp
RUN npm ci --omit=dev
RUN npm install sharp --platform=linuxmusl --arch=x64
COPY server ./server  # è¿™ä¼šè¦†ç›–æ‰é‡æ–°å®‰è£…çš„Sharpï¼

# âœ… æ­£ç¡®åšæ³•ï¼šåœ¨å¤åˆ¶ä»£ç åå®‰è£…Sharp
RUN npm ci --omit=dev
COPY server ./server
WORKDIR /app/server
RUN npm uninstall sharp
RUN npm install sharp --platform=linuxmusl --arch=x64
```

### 2. ğŸ”¥ ä¾èµ–åŒ…ç¼ºå¤±é—®é¢˜
**é—®é¢˜ç°è±¡**ï¼š
```
Error [ERR_MODULE_NOT_FOUND]: Cannot find package 'pg' imported from /app/server/services/database.js
```

**æ ¹æœ¬åŸå› **ï¼š
- server/package.jsonä¸­ç¼ºå°‘å¿…è¦çš„ä¾èµ–åŒ…
- npm ciéœ€è¦package-lock.jsonä¸package.jsonåŒæ­¥

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ·»åŠ ç¼ºå¤±ä¾èµ–åˆ°server/package.json
# 2. ç”Ÿæˆ/æ›´æ–°package-lock.json
cd server && npm install
# 3. æäº¤æ›´æ–°çš„lockæ–‡ä»¶
git add package-lock.json && git commit -m "fix: æ›´æ–°ä¾èµ–é”æ–‡ä»¶"
```

### 3. ğŸ”¥ Dockeræ„å»ºç¼“å­˜é—®é¢˜
**é—®é¢˜ç°è±¡**ï¼š
- ä¿®æ”¹äº†ä¾èµ–ä½†Dockeræ„å»ºä½¿ç”¨æ—§ç¼“å­˜
- æ„å»ºæˆåŠŸä½†è¿è¡Œæ—¶ä»ç„¶æŠ¥é”™

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ¸…ç†Dockerç¼“å­˜é‡æ–°æ„å»º
docker system prune -a
docker build --no-cache --platform linux/amd64 -t frankie0736/wp-image-uploader:latest .
```

### 4. ğŸ”¥ å¤šé˜¶æ®µæ„å»ºæ–‡ä»¶è¦†ç›–é—®é¢˜
**é—®é¢˜ç°è±¡**ï¼š
- åœ¨ä¸€ä¸ªé˜¶æ®µå®‰è£…/é…ç½®çš„æ–‡ä»¶è¢«åç»­é˜¶æ®µè¦†ç›–
- å¯¼è‡´è¿è¡Œæ—¶æ‰¾ä¸åˆ°æ­£ç¡®çš„æ–‡ä»¶

**å…³é”®åŸåˆ™**ï¼š
- **å…ˆå¤åˆ¶ä»£ç ï¼Œå†å®‰è£…/é…ç½®ä¾èµ–**
- **ç¡®ä¿å·¥ä½œç›®å½•åˆ‡æ¢æ­£ç¡®**
- **é¿å…COPYæ“ä½œè¦†ç›–å·²é…ç½®çš„ä¾èµ–**

## ğŸš¨ AIåŠ©æ‰‹è¡Œä¸ºå‡†åˆ™

### åœ¨æ‰§è¡Œä»»ä½•Gitæ“ä½œå‰
1. **å¿…é¡»å…ˆæ£€æŸ¥å½“å‰åˆ†æ”¯**ï¼šä½¿ç”¨`git branch`ç¡®è®¤å½“å‰åˆ†æ”¯
2. **ç¡®è®¤æ–‡ä»¶ä½ç½®**ï¼šæ£€æŸ¥è¦ä¿®æ”¹çš„æ–‡ä»¶æ˜¯å¦åœ¨æ­£ç¡®çš„åˆ†æ”¯
3. **éµå¾ªåˆ†æ”¯è§„åˆ™**ï¼šç¡®ä¿æ“ä½œç¬¦åˆåˆ†æ”¯ç®¡ç†è§„åˆ™

### ä»£ç ä¿®æ”¹åŸåˆ™
1. **æºä»£ç ä¿®æ”¹**ï¼šå¿…é¡»åœ¨devåˆ†æ”¯è¿›è¡Œ
2. **éƒ¨ç½²æ–‡ä»¶ä¿®æ”¹**ï¼šåœ¨devåˆ†æ”¯ä¿®æ”¹ååŒæ­¥åˆ°mainåˆ†æ”¯
3. **æµ‹è¯•éªŒè¯**ï¼šé‡è¦ä¿®æ”¹åå»ºè®®è¿›è¡Œæ„å»ºæµ‹è¯•

### Dockeræ„å»ºæ£€æŸ¥æ¸…å•
1. **ä¾èµ–å®Œæ•´æ€§**ï¼šç¡®ä¿package.jsonåŒ…å«æ‰€æœ‰å¿…è¦ä¾èµ–
2. **Lockæ–‡ä»¶åŒæ­¥**ï¼šç¡®ä¿package-lock.jsonä¸package.jsonåŒ¹é…
3. **å®‰è£…é¡ºåº**ï¼šå…ˆå¤åˆ¶ä»£ç ï¼Œå†å®‰è£…ç‰¹æ®Šä¾èµ–ï¼ˆå¦‚Sharpï¼‰
4. **å¹³å°å…¼å®¹æ€§**ï¼šä½¿ç”¨æ­£ç¡®çš„platformå’Œarchå‚æ•°
5. **å·¥ä½œç›®å½•**ï¼šç¡®ä¿åœ¨æ­£ç¡®ç›®å½•æ‰§è¡Œå‘½ä»¤

### é”™è¯¯å¤„ç†
1. **åˆ†æ”¯é”™è¯¯**ï¼šå¦‚æœå‘ç°åœ¨é”™è¯¯åˆ†æ”¯ï¼Œç«‹å³åœæ­¢æ“ä½œ
2. **æƒé™ç¡®è®¤**ï¼šä»»ä½•å¯èƒ½å½±å“åˆ†æ”¯ç»“æ„çš„æ“ä½œéƒ½è¦ç¡®è®¤
3. **å›æ»šå‡†å¤‡**ï¼šé‡è¦æ“ä½œå‰ç¡®ä¿æœ‰å›æ»šæ–¹æ¡ˆ

## ğŸ“ å¸¸ç”¨åœºæ™¯å¤„ç†

### åœºæ™¯1ï¼šæ·»åŠ æ–°åŠŸèƒ½
- åœ¨devåˆ†æ”¯å¼€å‘
- æµ‹è¯•å®Œæˆåæ›´æ–°Dockeré•œåƒ
- å¦‚éœ€æ›´æ–°éƒ¨ç½²é…ç½®ï¼ŒåŒæ­¥åˆ°mainåˆ†æ”¯

### åœºæ™¯2ï¼šä¿®å¤Bug
- åœ¨devåˆ†æ”¯ä¿®å¤
- å¦‚æœæ˜¯ç´§æ€¥ä¿®å¤ï¼Œå¯å…ˆåœ¨mainåˆ†æ”¯ä¿®å¤éƒ¨ç½²æ–‡ä»¶ï¼Œå†åŒæ­¥åˆ°devåˆ†æ”¯

### åœºæ™¯3ï¼šæ›´æ–°ä¾èµ–
- åœ¨devåˆ†æ”¯æ›´æ–°package.json
- é‡æ–°ç”Ÿæˆpackage-lock.json
- é‡æ–°æ„å»ºDockeré•œåƒ
- æµ‹è¯•æ— è¯¯åæ¨é€æ–°é•œåƒ

### åœºæ™¯4ï¼šSharpæˆ–å…¶ä»–ç¼–è¯‘ä¾èµ–é—®é¢˜
- æ£€æŸ¥Dockerfileä¸­çš„å®‰è£…é¡ºåº
- ç¡®ä¿åœ¨å¤åˆ¶ä»£ç åé‡æ–°å®‰è£…
- ä½¿ç”¨æ­£ç¡®çš„å¹³å°å‚æ•°
- æ¸…ç†Dockerç¼“å­˜é‡æ–°æ„å»º

## ğŸ¨ ä»£ç é£æ ¼è¦æ±‚

### JavaScript/React
- ä½¿ç”¨ES6+è¯­æ³•
- ä¼˜å…ˆä½¿ç”¨å‡½æ•°ç»„ä»¶å’ŒHooks
- ä½¿ç”¨Prettieræ ¼å¼åŒ–ä»£ç 
- éµå¾ªESLintè§„åˆ™

### APIè®¾è®¡
- RESTful APIè®¾è®¡
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- è¯¦ç»†çš„APIæ–‡æ¡£
- é€‚å½“çš„çŠ¶æ€ç ä½¿ç”¨

### æ–‡ä»¶ç»„ç»‡
- ç»„ä»¶æŒ‰åŠŸèƒ½æ¨¡å—ç»„ç»‡
- å·¥å…·å‡½æ•°å•ç‹¬å­˜æ”¾
- æ ·å¼æ–‡ä»¶ä¸ç»„ä»¶å¯¹åº”
- é…ç½®æ–‡ä»¶é›†ä¸­ç®¡ç†

---

**è®°ä½ï¼šè¸©è¿‡çš„å‘è¦è®°å½•ï¼Œé¿å…é‡å¤è¸©å‘ï¼å®‰å…¨çš„å¼€å‘æµç¨‹æ˜¯é¡¹ç›®ç¨³å®šæ€§çš„ä¿éšœï¼** 